{"version":3,"sources":["webpack:///./src/views/image/index.vue?145b","webpack:///./src/views/image/index.vue?fffd","webpack:///src/views/image/index.vue","webpack:///./src/views/image/index.vue?c518","webpack:///./src/views/image/index.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","staticStyle","attrs","dialogVisible","on","$event","headers","handleAvatarSuccess","beforeAvatarUpload","imageUrl","slot","_v","getToggle","model","value","callback","$$v","radio_all","expression","_l","item","index","key","ref","refInFor","url","collect","imagesQuery","page","per_page","total","currentPage","staticRenderFns","data","images","radio_collect","methods","newPage","getImage","setTimeout","isJPG","$message","error","isLt2M","created","component"],"mappings":"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","file":"js/chunk-bbbaeaf6.fc02a544.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-card',{staticClass:\"box-card\",staticStyle:{\"width\":\"100%\"}},[_c('el-dialog',{attrs:{\"title\":\"上传素材\",\"visible\":_vm.dialogVisible,\"width\":\"15%\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"headers\":_vm.headers,\"action\":\"http://ttapi.research.itcast.cn/mp/v1_0/user/images\",\"name\":\"image\",\"show-file-list\":false,\"on-success\":_vm.handleAvatarSuccess,\"before-upload\":_vm.beforeAvatarUpload}},[(_vm.imageUrl)?_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.imageUrl}}):_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\",staticStyle:{\"line-height\":\"178px\"}})])],1),_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('test',[_c('div',[_vm._v(\"素材管理\")])])],1),_c('div',[_c('el-radio-group',{attrs:{\"size\":\"medium\"},on:{\"change\":_vm.getToggle},model:{value:(_vm.radio_all),callback:function ($$v) {_vm.radio_all=$$v},expression:\"radio_all\"}},[_c('el-radio-button',{attrs:{\"label\":\"all\"}},[_vm._v(\"全部\")]),_c('el-radio-button',{attrs:{\"label\":\"collect\"}},[_vm._v(\"收藏\")])],1),_c('el-button',{staticStyle:{\"float\":\"right\"},attrs:{\"type\":\"success\"},on:{\"click\":function($event){_vm.dialogVisible = true}}},[_vm._v(\"添加素材\")])],1),_c('div',{staticClass:\"clearfix\",staticStyle:{\"width\":\"85%\"}},_vm._l((_vm.images),function(item,index){return _c('div',{key:index,ref:\"toggle_box\",refInFor:true,staticClass:\"block\",staticStyle:{\"width\":\"170px\",\"height\":\"170px\",\"float\":\"left\",\"margin\":\"15px 40px\"}},[_c('div',[_c('div',[_c('el-image',{staticStyle:{\"width\":\"170px\",\"height\":\"170px\"},attrs:{\"src\":item.url,\"fit\":\"fit\"}})],1),_c('el-button-group',[_c('el-button',{attrs:{\"type\":\"warning\",\"plain\":\"\",\"icon\":\"el-icon-star-off\"},on:{\"click\":function($event){return _vm.collect(item)}}}),_c('el-button',{attrs:{\"type\":\"danger\",\"plain\":\"\",\"icon\":\"el-icon-delete\"}})],1)],1)])}),0),_c('div',[_c('el-pagination',{attrs:{\"background\":\"\",\"page\":_vm.imagesQuery.page,\"page-size\":_vm.imagesQuery.per_page,\"layout\":\"prev, pager, next\",\"total\":_vm.total},on:{\"current-change\":_vm.currentPage}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <el-card class=\"box-card\" style=\"width:100%\">\r\n    <el-dialog title=\"上传素材\" :visible.sync=\"dialogVisible\" width=\"15%\">\r\n      <el-upload\r\n        class=\"avatar-uploader\"\r\n        :headers=\"headers\"\r\n        action=\"http://ttapi.research.itcast.cn/mp/v1_0/user/images\"\r\n        name='image'\r\n        :show-file-list=\"false\"\r\n        :on-success=\"handleAvatarSuccess\"\r\n        :before-upload=\"beforeAvatarUpload\"\r\n      >\r\n        <img v-if=\"imageUrl\" :src=\"imageUrl\" class=\"avatar\" />\r\n        <i v-else class=\"el-icon-plus avatar-uploader-icon\" style=\"line-height:178px\"></i>\r\n      </el-upload>\r\n    </el-dialog>\r\n    <div slot=\"header\" class=\"clearfix\">\r\n      <test>\r\n        <div>素材管理</div>\r\n      </test>\r\n    </div>\r\n    <div>\r\n      <el-radio-group v-model=\"radio_all\" @change=\"getToggle\" size=\"medium\">\r\n        <el-radio-button label=\"all\">全部</el-radio-button>\r\n        <el-radio-button label=\"collect\">收藏</el-radio-button>\r\n      </el-radio-group>\r\n      <el-button type=\"success\" style=\"float:right\" @click=\"dialogVisible = true\">添加素材</el-button>\r\n    </div>\r\n    <div style=\"width:85%\" class=\"clearfix\">\r\n     <div\r\n        ref=\"toggle_box\"\r\n        class=\"block\"\r\n        v-for=\"(item,index) in images\"\r\n        :key=\"index\"\r\n        style=\"width: 170px; height: 170px;float:left;margin:15px 40px\"\r\n      >\r\n        <div>\r\n          <div>\r\n            <el-image style=\"width: 170px; height: 170px\" :src=\"item.url\" fit=\"fit\"></el-image>\r\n          </div>\r\n\r\n          <el-button-group>\r\n            <el-button type=\"warning\" plain icon=\"el-icon-star-off\" @click=\"collect(item)\"></el-button>\r\n            <el-button type=\"danger\" plain icon=\"el-icon-delete\"></el-button>\r\n          </el-button-group>\r\n\r\n          </div>\r\n        </div>\r\n\r\n    </div>\r\n    <div>\r\n        <el-pagination\r\n        background\r\n        :page='imagesQuery.page'\r\n        :page-size='imagesQuery.per_page'\r\n        layout=\"prev, pager, next\"\r\n        @current-change='currentPage'\r\n        :total=\"total\">\r\n        </el-pagination>\r\n      </div>\r\n  </el-card>\r\n</template>\r\n\r\n<script>\r\nimport local from '@/utils/local'\r\nexport default {\r\n  data () {\r\n    return {\r\n      total: 0,\r\n      images: [],\r\n      imagesQuery: {\r\n        page: 1,\r\n        per_page: 10,\r\n        collect: false\r\n      },\r\n      radio_all: 'all',\r\n      radio_collect: 'collect',\r\n      dialogVisible: false,\r\n      imageUrl: '',\r\n      headers: { Authorization: `Bearer ${local.getUser().token}` }\r\n    }\r\n  },\r\n  methods: {\r\n    currentPage (newPage) {\r\n      this.imagesQuery.page = newPage\r\n      this.getImage()\r\n    },\r\n    async getImage () {\r\n      const {\r\n        data: { data }\r\n      } = await this.$http.get('/user/images', { params: this.imagesQuery })\r\n      this.images = data.results\r\n      this.total = data.total_count\r\n      this.imagesQuery.page = data.page\r\n      this.imagesQuery.per_page = data.per_page\r\n    },\r\n    getToggle () {\r\n      this.imagesQuery.collect = !this.imagesQuery.collect\r\n      this.getImage()\r\n    },\r\n    async collect (item) {\r\n      await this.$http.put(`user/images/${item.id}`, {\r\n        collect: !item.is_collected\r\n      })\r\n      this.getImage()\r\n    },\r\n    handleAvatarSuccess (res, file) {\r\n      // this.imageUrl = URL.createObjectURL(file.raw)\r\n      setTimeout(() => {\r\n        this.dialogVisible = false\r\n      }, 3000)\r\n    },\r\n    beforeAvatarUpload (file) {\r\n      const isJPG = file.type === 'image/jpeg'\r\n      const isLt2M = file.size / 1024 / 1024 < 2\r\n\r\n      if (!isJPG) {\r\n        this.$message.error('上传头像图片只能是 JPG 格式!')\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error('上传头像图片大小不能超过 2MB!')\r\n      }\r\n      return isJPG && isLt2M\r\n    }\r\n\r\n  },\r\n  created () {\r\n    this.getImage()\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.block {\r\n  position: relative;\r\n}\r\n.block .el-button-group {\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0px;\r\n  width: 170px;\r\n}\r\n.block .el-button-group button {\r\n  border-radius: 0;\r\n  background: rgba(0, 0, 0, 0.6);\r\n  color: #fff;\r\n  width: 85px;\r\n  border: none;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=21b81a0a&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}